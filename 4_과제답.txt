2page
sqldb 데이터베이스에서 다음 조건을 처리하세요.
○ 사용자별로 구매 이력을 출력함
○ 모든 컬럼을 출력함
○ 구매 이력이 없는 정보는 출력하지 않음
앞의 결과에서 userID가 'JYP'인 데이터만 출력하세요.
SELECT *
FROM buytbl b INNER JOIN usertbl u
ON b.userID = u.userID
WHERE b.userID = 'JYP';

3page
sqldb 데이터베이스에서 다음 조건을 처리하세요.
○ 각 사용자별로 구매 이력을 출력하세요.
○ 연결 컬럼은 userID로 함
○ 결과를 userID를 기준으로 오름차순으로 정렬함
○ 구매이력이 없는 사용자도 출력하세요.
○ userID, name, prodName, addr, 연락처를 다음과 같이 출력함
SELECT u.userID, u.name, b.prodName, u.addr,
CONCAT(u.mobile1, u.mobile2) as 연락처
FROM usertbl u
LEFT OUTER JOIN buytbl b
ON u.userID = b.userID
ORDER BY u.userID;

4page
sqldb의 사용자를 모두 조회하되 전화가 없는 사람은 제외하고 출력하세요.
SELECT name, CONCAT(mobile1, mobile2) AS '전화번호'
FROM usertbl
WHERE name NOT IN(SELECT name FROM usertbl WHERE mobile1 IS NULL);

sqldb의 사용자를 모두 조회하되 전화가 없는 사람만 출력하세요.
SELECT name, CONCAT(mobile1, mobile2) AS '전화번호'
FROM usertbl
WHERE name IN(SELECT name FROM usertbl WHERE mobile1 IS NULL);

심화문제
다음과 같이 테이블과 데이터를 준비하세요.
USE sqldb;
DROP TABLE stdclubtbl;
DROP TABLE stdtbl;
DROP TABLE clubtbl;
CREATE TABLE stdtbl( stdname varchar(10) not null primary key, addr char(4) not null);
CREATE TABLE clubtbl( clubname varchar(10) NOT NULL primary key, roomno char(4) not null);
create table stdclubtbl(num int auto_increment not null primary key,
stdname varchar(10) references stdtbl(stdname),
clubname varchar(10) references clubtbl(clubname));
INSERT INTO stdtbl VALUES ('김범수', '경남'), ('성시경', '서울'), ('조용필', '경기'), ('은지원', '경북'),('바비킴', '서울');
INSERT INTO clubtbl VALUES ('수영', '101호'), ('바둑', '102호'), ('축구', '103호'), ('봉사', '104호');
INSERT INTO stdclubtbl VALUES (NULL, '김범수', '바둑'),
(NULL, '김범수', '축구'),
(NULL, '조용필', '축구'),
(NULL, '은지원', '축구'),
(NULL, '은지원', '봉사'),
(NULL, '바비킴', '봉사');

심화문제 4page
학생 테이블, 동아리 테이블, 학생 동아리 테이블을 이용해서 학생을 기준으로 학생 이름/지역/가입한 동아리/
동아리방을 출력하세요.
SELECT S.stdName, S.addr, SC.clubName, C.roomNo
FROM stdtbl S
INNER JOIN stdclubtbl SC
ON S.stdName = SC.stdName
INNER JOIN clubtbl C
ON SC.clubName = C.clubName
ORDER BY S.stdName;

심화문제 4page
동아리를 기준으로 가입한 학생의 clubName, roomNo, stdName, addr을 출력하세요.
SELECT C.clubName, C.roomNo, S.stdName, S.addr
FROM stdtbl S
INNER JOIN stdclubtbl SC
ON SC.stdName = S.stdName
INNER JOIN clubtbl C
ON SC.clubName = C.clubName
ORDER BY C.clubName;

심화문제 5page
다음과 같이 테이블과 데이터를 준비하세요.
CREATE TABLE empTbl(emp CHAR(3), manager CHAR(3), empTel VARCHAR(8));
INSERT INTO empTbl VALUES('나사장', NULL, '0000');
INSERT INTO empTbl VALUES('김재무', '나사장', '2222');
INSERT INTO empTbl VALUES('김부장', '김재무', '2222-1');
INSERT INTO empTbl VALUES('이부장', '김재무', '2222-2');
INSERT INTO empTbl VALUES('우대리', '이부장', '2222-2-1');
INSERT INTO empTbl VALUES('지사원', '이부장', '2222-2-2');
INSERT INTO empTbl VALUES('이영업', '나사장', '1111');
INSERT INTO empTbl VALUES('한과장', '이영업', '1111-1');
INSERT INTO empTbl VALUES('최정보', '나사장', '3333');
INSERT INTO empTbl VALUES('윤차장', '최정보', '3333-1');
INSERT INTO empTbl VALUES('이주임', '윤차장', '3333-1-1');

심화문제 6page
'우대리'의 직속상관, 직속상관연락처를 출력하세요
SELECT A.emp AS '사원', B.emp AS '직속상관', B.empTel AS '직속상관연락처'
FROM empTbl A
INNER JOIN empTbl B
ON A.manager = B.emp
WHERE A.emp = '우대리';

심화문제 9page
현재 재직 중인 직원의 정보(emp_no, first_name, last_name, title)를 출력하세요
select e.emp_no, e.first_name, e.last_name, title
from titles t
INNER JOIN employees e
ON t.emp_no = e.emp_no
where t.to_date = '9999-01-01';

심화문제 10page
현재 재직 중인 직원 정보(emp_no, first_name, last_name, title, salary)를 출력하세요
SELECT e.*, t.title, s.salary
FROM titles t
INNER JOIN employees e
ON t.emp_no = e.emp_no
INNER JOIN salaries s
ON t.emp_no = s.emp_no
WHERE t.to_date = '9999-01-01'
AND s.to_date = '9999-01-01';

심화문제 11page
현재 재직중인 직원의 정보(emp_no, first_name, last_name, department)를 출력하세요.
정렬: emp_no 오름 차순
select e.emp_no, e.first_name, e.last_name, d.dept_name
from departments d
inner join dept_emp de
on d.dept_no = de.dept_no
inner join employees e
on de.emp_no = e.emp_no
where de.to_date = '9999-01-01'
order by e.emp_no;

심화문제12page
부서별 부서 번호, 부서명, 재직중인 직원의 수를 출력하세요.
정렬: 부서 번호 오름차순
select d.dept_no, d.dept_name, COUNT(*)
from departments d
inner join dept_emp de
on d.dept_no = de.dept_no
inner join employees e
on de.emp_no = e.emp_no
where de.to_date = '9999-01-01'
group by d.dept_no
order by d.dept_no;

심화문제 13page
직원 번호가 10209인 직원의 정보(emp_no, first_name, last_name)와 
부서 정보(dept_name, from_date, to_date)를  출력하세요.
select e.emp_no, e.first_name, e.last_name, d.dept_name, de.from_date, de.to_date
from departments d
inner join dept_emp de
on d.dept_no = de.dept_no
inner join employees e
on de.emp_no = e.emp_no
where e.emp_no = 10209;